<!DOCTYPE html>
<html lang='en'>

<head>
  <meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='description' content='I recently had an issue where I wanted to plot a line connecting the monotonically increasing part of some subset of the data. So I figured I would try to make my own ggplot2 layer to do it.
It’s actually pretty straightforward! The first step is to read the documentation for extending ggplot2. A helpful quote if you ever have impostor syndrome:
 As you read this document, you’ll see many things that will make you scratch your head and wonder why on earth is it designed this way?'>

<meta property='og:title' content='Plotting a Monotonic Increasing Sequence • gzt does statistics'>
<meta property='og:description' content='I recently had an issue where I wanted to plot a line connecting the monotonically increasing part of some subset of the data. So I figured I would try to make my own ggplot2 layer to do it.
It’s actually pretty straightforward! The first step is to read the documentation for extending ggplot2. A helpful quote if you ever have impostor syndrome:
 As you read this document, you’ll see many things that will make you scratch your head and wonder why on earth is it designed this way?'>
<meta property='og:url' content='http://gzt.github.io/post/plotting-a-monotonic-increasing-sequence/'>
<meta property='og:site_name' content='gzt does statistics'>
<meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='ggplot2'><meta property='article:tag' content='graphics'><meta property='article:tag' content='R'><meta property='article:published_time' content='2019-04-22T00:00:00Z'/><meta property='article:modified_time' content='2019-04-22T00:00:00Z'/><meta name='twitter:card' content='summary'>

<meta name="generator" content="Hugo 0.36" />

  <title>Plotting a Monotonic Increasing Sequence • gzt does statistics</title>
  <link rel='canonical' href='http://gzt.github.io/post/plotting-a-monotonic-increasing-sequence/'>
  
  
  <link rel='icon' href='/favicon.ico'>
<link rel='stylesheet' href='/assets/css/main.22d77285.css'><link rel='stylesheet' href='/css/custom.css'>
</head>


<body class='page type-post has-sidebar sidebar-sticky'>

  <div class='site'>

    <a class='screen-reader-text' href='#main-menu'>Skip to Main Menu</a>

<div id='sidebar' class='sidebar'>
  <div class='container'><section class='widget widget-about sep-after'>
  <header>
    
    <div class='logo'>
      <a href='/'>
        <img src='/2553342.jpg'>
      </a>
    </div>
    
    <h2 class='title site-title '>
    gzt does statistics
    </h2>
    <div class='desc'>
    inverted matrix variate gzt distribution
    </div>
  </header>

</section>
<section class='widget widget-taxonomy_cloud sep-after'>
  <header>
    <h4 class='title widget-title'>Tags</h4>
  </header>

  <div class='container list-container'>
  <ul class='list taxonomy-cloud'><li>
        <a href='/tags/c' style='font-size:1.1em'>C</a>
      </li><li>
        <a href='/tags/r' style='font-size:2em'>R</a>
      </li><li>
        <a href='/tags/wishart' style='font-size:1.2em'>Wishart</a>
      </li><li>
        <a href='/tags/classification' style='font-size:1.1em'>Classification</a>
      </li><li>
        <a href='/tags/computing' style='font-size:1em'>Computing</a>
      </li><li>
        <a href='/tags/ethics' style='font-size:1em'>Ethics</a>
      </li><li>
        <a href='/tags/ggplot2' style='font-size:1.1em'>Ggplot2</a>
      </li><li>
        <a href='/tags/graphics' style='font-size:1.1em'>Graphics</a>
      </li><li>
        <a href='/tags/linear-algebra' style='font-size:1.4em'>Linear algebra</a>
      </li><li>
        <a href='/tags/matrix-variate' style='font-size:1.3em'>Matrix variate</a>
      </li><li>
        <a href='/tags/matrixdist' style='font-size:1.3em'>Matrixdist</a>
      </li><li>
        <a href='/tags/multivariate' style='font-size:1.1em'>Multivariate</a>
      </li><li>
        <a href='/tags/optimization' style='font-size:1.1em'>Optimization</a>
      </li><li>
        <a href='/tags/profiling' style='font-size:1.2em'>Profiling</a>
      </li><li>
        <a href='/tags/randomness' style='font-size:1em'>Randomness</a>
      </li><li>
        <a href='/tags/social-responsibility' style='font-size:1em'>Social responsibility</a>
      </li><li>
        <a href='/tags/statistics' style='font-size:1em'>Statistics</a>
      </li><li>
        <a href='/tags/unconference' style='font-size:1em'>Unconference</a>
      </li></ul>
</div>


</section>
</div>
</div>

    <div class='main'>

      <nav id='main-menu' class='main-menu' aria-label='Main Menu'>
  <div class='container'>
    <a class='screen-reader-text' href='#content'>Skip to Content</a>

<button id='sidebar-toggler' class='hamburger hamburger--arrow sidebar-toggler' type='button' aria-controls='sidebar' aria-expanded='false'>
  <span class='screen-reader-text'>Toggle Sidebar</span>
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
    <ul><li class='item'>
        <a href='/'>Home</a>
      </li><li class='item'>
        <a href='/about/'>About</a>
      </li><li class='item'>
        <a href='https://github.com/gzt/'>Repo</a>
      </li><li class='item'>
        <a href='/categories/'>Categories</a>
      </li><li class='item'>
        <a href='/tags/'>Tags</a>
      </li></ul>
  </div>
</nav>


      <header id='header' class='header site-header'>
        <div class='container sep-after'>
          <div class='header-info'><p class='site-title title'>gzt does statistics</p><p class='desc site-desc'>inverted matrix variate gzt distribution</p>
          </div>
        </div>
      </header>

      <main id='content'>


<article lang='en' class='entry'>
  <header class='header entry-header'>
  <div class='container sep-after'>
    <div class='header-info'>
      <h1 class='title'>Plotting a Monotonic Increasing Sequence</h1>
      

    </div>
    
<div class='entry-meta'>
  <span class='posted-on'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
  <line x1="16" y1="2" x2="16" y2="6"/>
  <line x1="8" y1="2" x2="8" y2="6"/>
  <line x1="3" y1="10" x2="21" y2="10"/>
  
</svg>
<span class='screen-reader-text'>Posted on </span>
  <time class='entry-date' datetime='2019-04-22T00:00:00Z'>2019, Apr 22</time>
</span>

  
  
<span class='reading-time'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <circle cx="12" cy="12" r="10"/>
  <polyline points="12 6 12 12 15 15"/>
  
</svg>
6 mins read
</span>


</div>


  </div>
</header>

  
  

  <div class='container entry-content'>
  <script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/rmarkdown-libs/plotly-binding/plotly.js"></script>
<script src="/rmarkdown-libs/typedarray/typedarray.min.js"></script>
<script src="/rmarkdown-libs/jquery/jquery.min.js"></script>
<link href="/rmarkdown-libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="/rmarkdown-libs/crosstalk/js/crosstalk.min.js"></script>
<link href="/rmarkdown-libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="/rmarkdown-libs/plotly-main/plotly-latest.min.js"></script>


<p>I recently had an issue where I wanted to plot a line connecting the monotonically increasing part of some subset of the data. So I figured I would try to make my own <code>ggplot2</code> layer to do it.</p>
<p>It’s actually pretty straightforward! The first step is to read the <a href="https://ggplot2.tidyverse.org/articles/extending-ggplot2.html">documentation</a> for extending <code>ggplot2</code>. A helpful quote if you ever have impostor syndrome:</p>
<blockquote>
<p>As you read this document, you’ll see many things that will make you scratch your head and wonder why on earth is it designed this way? Mostly it’s historical accident - I wasn’t a terribly good R programmer when I started writing <code>ggplot2</code> and I made a lot of questionable decisions.</p>
</blockquote>
<p>It would be weird if you were trying something big and hard and new and weren’t feeling a bit nervous and out of place. If we say that we have no sin, we deceive ourselves, and the truth is not in us. You can do it, though, dear reader. I believe in you, and the R community is very helpful in these great and final days.</p>
<p>The first problem is, given some set of data, how to find that monotonically increasing part. It’s a fairly straightfoward idea: sort in terms of the <code>x</code> variable, step through and note the points where the observed <code>y</code> variable is higher than any point you’ve seen before.</p>
<pre class="r"><code>monoselect &lt;- function(x, y)
{
  if (missing(y) || is.null(y))
    stop(&quot;numeric y must be supplied.&quot;)

  ord &lt;- order(x)
  len &lt;- length(x)
  if (len != length(y)) stop(&quot;y must have same length as x.&quot;)
  returnvec = ord[1]
  tmp = y[ord[1]]
  for (i in 2:length(x)) {
    if (y[ord[i]] &gt;= tmp) {
      returnvec = c(returnvec, ord[i])
      tmp = y[ord[i]]
    }
  }
  returnvec
}</code></pre>
<p>This is precisely analogous to the <code>chull</code> example in the documentation, so we can make a similar change as there:</p>
<pre class="r"><code>library(ggplot2)
# make new stat based on monoselect
StatMono &lt;- ggproto(&quot;StatMono&quot;, Stat,
                     compute_group = function(data, scales) {
                       data[monoselect(data$x, data$y), , drop = FALSE]
                     },

                     required_aes = c(&quot;x&quot;, &quot;y&quot;)
)

# make new layer based on StatMono
stat_mono &lt;- function(mapping = NULL, data = NULL, geom = &quot;line&quot;,
                       position = &quot;identity&quot;, na.rm = FALSE, show.legend = NA,
                       inherit.aes = TRUE, ...) {
  layer(
    stat = StatMono, data = data, mapping = mapping, geom = geom,
    position = position, show.legend = show.legend, inherit.aes = inherit.aes,
    params = list(na.rm = na.rm, ...)
  )
}</code></pre>
<p>What it looks like:</p>
<pre class="r"><code>set.seed(20190422)
library(tibble)
df &lt;- tibble(group = rep(c(&#39;A&#39;,&#39;B&#39;), times = 50),
             x = rep(1:50, 2),
             y = (rep(1:2, times = 50) * x + 7 * rnorm(100)))
p &lt;- ggplot(data = df, mapping = aes(color = group, x = x, y = y)) +
        geom_point() + 
        stat_mono(aes(color = group)) +
        NULL
plotly::ggplotly(p)</code></pre>
<pre><code>## Loading required namespace: shiny</code></pre>
<div id="htmlwidget-1" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"data":[{"x":[1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49],"y":[9.51904276957729,0.597863063016643,9.76075858352819,8.58112785199748,4.3372543831276,6.48275562483995,6.76362502429791,13.451654823568,17.0528129739117,14.9799622043644,27.7691544301783,17.9441128723377,16.9501604211097,22.0621607710687,30.772251118278,23.6550849139816,30.8595348314497,36.0061433279564,28.6626633146733,29.6708788333768,39.2290915266041,50.1539070070656,53.6414772047956,54.4277171685957,51.884202596001,6.66503137638985,12.3408183080117,-0.911055080569936,-0.466945190240422,10.5954452122009,20.2660186162113,7.4928059208638,16.6030602434175,22.6980096603878,25.9256419147181,20.6944585856327,25.0022954257783,22.2275123763132,25.1983282760001,34.9146460483069,39.4154039777058,35.8854373982734,47.8162780815834,26.3931910688409,41.6746763229424,44.640634984917,46.6493634262017,46.9685310630233,52.5463344867805,56.1806626145862],"text":["x:  1<br />y:   9.5190428","x:  3<br />y:   0.5978631","x:  5<br />y:   9.7607586","x:  7<br />y:   8.5811279","x:  9<br />y:   4.3372544","x: 11<br />y:   6.4827556","x: 13<br />y:   6.7636250","x: 15<br />y:  13.4516548","x: 17<br />y:  17.0528130","x: 19<br />y:  14.9799622","x: 21<br />y:  27.7691544","x: 23<br />y:  17.9441129","x: 25<br />y:  16.9501604","x: 27<br />y:  22.0621608","x: 29<br />y:  30.7722511","x: 31<br />y:  23.6550849","x: 33<br />y:  30.8595348","x: 35<br />y:  36.0061433","x: 37<br />y:  28.6626633","x: 39<br />y:  29.6708788","x: 41<br />y:  39.2290915","x: 43<br />y:  50.1539070","x: 45<br />y:  53.6414772","x: 47<br />y:  54.4277172","x: 49<br />y:  51.8842026","x:  1<br />y:   6.6650314","x:  3<br />y:  12.3408183","x:  5<br />y:  -0.9110551","x:  7<br />y:  -0.4669452","x:  9<br />y:  10.5954452","x: 11<br />y:  20.2660186","x: 13<br />y:   7.4928059","x: 15<br />y:  16.6030602","x: 17<br />y:  22.6980097","x: 19<br />y:  25.9256419","x: 21<br />y:  20.6944586","x: 23<br />y:  25.0022954","x: 25<br />y:  22.2275124","x: 27<br />y:  25.1983283","x: 29<br />y:  34.9146460","x: 31<br />y:  39.4154040","x: 33<br />y:  35.8854374","x: 35<br />y:  47.8162781","x: 37<br />y:  26.3931911","x: 39<br />y:  41.6746763","x: 41<br />y:  44.6406350","x: 43<br />y:  46.6493634","x: 45<br />y:  46.9685311","x: 47<br />y:  52.5463345","x: 49<br />y:  56.1806626"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"A","legendgroup":"A","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50],"y":[-1.35913484120724,10.5430493778712,17.4102832780639,19.2805694760223,21.2769310310563,21.3202940778763,32.1007645849028,32.9338430286533,31.0537076567187,41.4668018172885,37.119023534595,48.5663476083618,52.7876530408006,52.3680797549538,63.0503788591184,61.745742412767,80.5416763752833,53.2365513940068,78.1427811993925,79.0879415988294,84.8378116717478,84.4619282629014,79.7725353111312,93.1516029270746,99.2528213671259,-1.69017124946154,18.0206045491019,16.1203384083303,19.9885359700497,25.7090261754881,16.6098000411654,36.4145525314334,26.9961905485012,29.9056549986472,49.9310389798708,41.6293192143798,47.0829456652665,56.0425757787291,60.5178159380943,47.3873008378931,52.1379245742615,64.6260349839742,77.7664927429668,89.5114149346269,78.7290274670065,81.5275577057754,85.2568218044001,97.9016573709297,101.440800289075,93.7941348459127],"text":["x:  2<br />y:  -1.3591348","x:  4<br />y:  10.5430494","x:  6<br />y:  17.4102833","x:  8<br />y:  19.2805695","x: 10<br />y:  21.2769310","x: 12<br />y:  21.3202941","x: 14<br />y:  32.1007646","x: 16<br />y:  32.9338430","x: 18<br />y:  31.0537077","x: 20<br />y:  41.4668018","x: 22<br />y:  37.1190235","x: 24<br />y:  48.5663476","x: 26<br />y:  52.7876530","x: 28<br />y:  52.3680798","x: 30<br />y:  63.0503789","x: 32<br />y:  61.7457424","x: 34<br />y:  80.5416764","x: 36<br />y:  53.2365514","x: 38<br />y:  78.1427812","x: 40<br />y:  79.0879416","x: 42<br />y:  84.8378117","x: 44<br />y:  84.4619283","x: 46<br />y:  79.7725353","x: 48<br />y:  93.1516029","x: 50<br />y:  99.2528214","x:  2<br />y:  -1.6901712","x:  4<br />y:  18.0206045","x:  6<br />y:  16.1203384","x:  8<br />y:  19.9885360","x: 10<br />y:  25.7090262","x: 12<br />y:  16.6098000","x: 14<br />y:  36.4145525","x: 16<br />y:  26.9961905","x: 18<br />y:  29.9056550","x: 20<br />y:  49.9310390","x: 22<br />y:  41.6293192","x: 24<br />y:  47.0829457","x: 26<br />y:  56.0425758","x: 28<br />y:  60.5178159","x: 30<br />y:  47.3873008","x: 32<br />y:  52.1379246","x: 34<br />y:  64.6260350","x: 36<br />y:  77.7664927","x: 38<br />y:  89.5114149","x: 40<br />y:  78.7290275","x: 42<br />y:  81.5275577","x: 44<br />y:  85.2568218","x: 46<br />y:  97.9016574","x: 48<br />y: 101.4408003","x: 50<br />y:  93.7941348"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)"}},"hoveron":"points","name":"B","legendgroup":"B","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,3,11,17,19,21,29,29,31,35,43,45,47,49],"y":[9.51904276957729,12.3408183080117,20.2660186162113,22.6980096603878,25.9256419147181,27.7691544301783,30.772251118278,34.9146460483069,39.4154039777058,47.8162780815834,50.1539070070656,53.6414772047956,54.4277171685957,56.1806626145862],"text":["x:  1<br />y:   9.519043","x:  3<br />y:  12.340818","x: 11<br />y:  20.266019","x: 17<br />y:  22.698010","x: 19<br />y:  25.925642","x: 21<br />y:  27.769154","x: 29<br />y:  30.772251","x: 29<br />y:  34.914646","x: 31<br />y:  39.415404","x: 35<br />y:  47.816278","x: 43<br />y:  50.153907","x: 45<br />y:  53.641477","x: 47<br />y:  54.427717","x: 49<br />y:  56.180663"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"A","legendgroup":"A","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2,4,4,8,8,10,10,14,14,20,20,26,26,28,30,34,38,46,48],"y":[-1.35913484120724,10.5430493778712,18.0206045491019,19.2805694760223,19.9885359700497,21.2769310310563,25.7090261754881,32.1007645849028,36.4145525314334,41.4668018172885,49.9310389798708,52.7876530408006,56.0425757787291,60.5178159380943,63.0503788591184,80.5416763752833,89.5114149346269,97.9016573709297,101.440800289075],"text":["x:  2<br />y:  -1.359135","x:  4<br />y:  10.543049","x:  4<br />y:  18.020605","x:  8<br />y:  19.280569","x:  8<br />y:  19.988536","x: 10<br />y:  21.276931","x: 10<br />y:  25.709026","x: 14<br />y:  32.100765","x: 14<br />y:  36.414553","x: 20<br />y:  41.466802","x: 20<br />y:  49.931039","x: 26<br />y:  52.787653","x: 26<br />y:  56.042576","x: 28<br />y:  60.517816","x: 30<br />y:  63.050379","x: 34<br />y:  80.541676","x: 38<br />y:  89.511415","x: 46<br />y:  97.901657","x: 48<br />y: 101.440800"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"B","legendgroup":"B","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":43.1050228310502},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.45,52.45],"tickmode":"array","ticktext":["0","10","20","30","40","50"],"tickvals":[0,10,20,30,40,50],"categoryorder":"array","categoryarray":["0","10","20","30","40","50"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"x","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-6.84671982638839,106.597348866002],"tickmode":"array","ticktext":["0","25","50","75","100"],"tickvals":[0,25,50,75,100],"categoryorder":"array","categoryarray":["0","25","50","75","100"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"y","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.96751968503937},"annotations":[{"text":"group","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"69f461ba97c8":{"x":{},"y":{},"colour":{},"type":"scatter"},"69f4a3e0169":{"colour":{},"x":{},"y":{},"colour.1":{}}},"cur_data":"69f461ba97c8","visdat":{"69f461ba97c8":["function (y) ","x"],"69f4a3e0169":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>Incidentally, if you don’t know this trick, give it a whirl: when you’re adding to a <code>ggplot</code>, write your code as <code>whatever() +</code> and throw a <code>NULL</code> at the end. It makes it easier to add or comment out lines without worrying about killing the plot.</p>
<p>Next I am interested in finding local maxima, I haven’t written the functions yet, but here is what I want to accomplish:</p>
<pre class="r"><code>nreps = 30
df &lt;- tibble( x = rep(1:10, each = nreps) + rnorm(10*nreps, sd = 0.2), 
              means = rep(sample(1:10, 10, replace = TRUE), each = nreps),
              y = rnorm(10*nreps, means, 3))
qplot(x,y,data=df) + theme_bw()</code></pre>
<p><img src="/post/2019-04-22-plotting-a-monotonic-increasing-sequence_files/figure-html/whatiwant-1.png" width="672" /></p>
<p>I want to have the local maxima marked by a curve in a LOESS-like fashion, probably with a specified bandwidth. Whether it catches the dip at approximately 7 or not depends on the bandwidth, but it certainly shouldn’t think the maximum just after 5 is where the line should stay forever. I’ll get around to writing this soon.</p>
<p>I don’t know if these two functions are worth turning into a package, but they’d be useful enough for a couple things I’m doing at the moment. Whatever the case, here you got to see my first attempt at making my own <code>ggplot2</code> extensions. If you write something for the open question at the end here before I do, let me know.</p>

</div>

  
<footer class='entry-footer'>
  <div class='container sep-before'>
  <div class='categories'>
  <span class='taxonomy-icon'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M22,19a2,2,0,0,1-2,2H4a2,2,0,0,1-2-2V5A2,2,0,0,1,4,3H9l2,3h9a2,2,0,0,1,2,2Z"/>
  
</svg>
</span>
  <span class='screen-reader-text'>Categories: </span><a class='category' href='/categories/r'>R</a></div>
<div class='tags'>
  <span class='taxonomy-icon'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M20.59,13.41l-7.17,7.17a2,2,0,0,1-2.83,0L2,12V2H12l8.59,8.59A2,2,0,0,1,20.59,13.41Z"/>
  <line x1="7" y1="7" x2="7" y2="7"/>
  
</svg>
</span>
  <span class='screen-reader-text'>Tags: </span><a class='tag' href='/tags/ggplot2'>Ggplot2</a>, <a class='tag' href='/tags/graphics'>Graphics</a>, <a class='tag' href='/tags/r'>R</a></div>

  </div>
</footer>


</article>

<nav class='entry-nav'>
  <div class='container'><div class='prev-entry sep-before'>
      <a href='/post/the-r-uncoast-unconference/'>
        <span aria-hidden='true'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="20" y1="12" x2="4" y2="12"/>
  <polyline points="10 18 4 12 10 6"/>
  
</svg>
 Previous</span>
        <span class='screen-reader-text'>Previous post: </span>The R Uncoast Unconference</a>
    </div></div>
</nav>



      </main>

      <footer id='footer' class='footer'>
        <div class='container sep-before'>
          <section class='widget widget-social_menu sep-after'><nav aria-label='Social Menu'>
    <ul><li>
        <a href='https://github.com/gzt' target='_blank' rel='noopener'>
          <span class='screen-reader-text'>Open Github account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
  
</svg>
</a>
      </li><li>
        <a href='https://twitter.com/gztstatistics' target='_blank' rel='noopener'>
          <span class='screen-reader-text'>Open Twitter account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"/>
  
</svg>
</a>
      </li><li>
        <a href='mailto:gzthompson@gmail.com' target='_blank' rel='noopener'>
          <span class='screen-reader-text'>Contact via Email</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
  <polyline points="22,6 12,13 2,6"/>
  
</svg>
</a>
      </li><li>
        <a href='https://linkedin.com/in/geoffreyzthompson' target='_blank' rel='noopener'>
          <span class='screen-reader-text'>Open Linkedin account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"/>
  <rect x="2" y="9" width="4" height="12"/>
  <circle cx="4" cy="4" r="2"/>
  
</svg>
</a>
      </li></ul>
  </nav>
</section>

          <div class='copyright'>
  <p> &copy; 2018-2019 g z thompson </p>
</div>

        </div>
      </footer>

    </div>
  </div><div class='sidebar-overlay'></div><script src='/assets/js/main.89545a27.js'></script><script src='/js/custom.js'></script><script src="//yihui.name/js/math-code.js"></script>
<script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>

<script async src="//yihui.name/js/center-img.js"></script>
</body>

</html>

